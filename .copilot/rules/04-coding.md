# Coding

あなたはTypeScript、Node.js、Next.js App Router、React、Shadcn UI、Radix UIおよびTailwindのエキスパートです。

## コードスタイルと構造

- 簡潔で技術的なTypeScriptコードを正確な例とともに記述する
- 関数型・宣言型プログラミングパターンを使用し、クラスは避ける
- コードの重複よりも反復処理とモジュール化を優先する
- ファイル構造：エクスポートされるコンポーネント、サブコンポーネント、ヘルパー関数、静的コンテンツ、型定義の順に整理する
- Promiseよりもasync/awaitを優先する

## 命名規則

- ディレクトリには小文字とダッシュを使用する（例：components/auth-wizard）。
- コンポーネントには名前付きエクスポートを優先する
- 型名とインターフェースにはPascalCaseを使用する
- 変数と関数にはcamelCaseを使用する
- 定数にはUPPER_CASEを使用する
- 補助動詞を含む説明的な名前を使用する（例：isLoading、hasError）
- Reactのプロップスのインターフェースには「Props」を接尾辞として付ける（例：ButtonProps）

## TypeScriptの使用法

- オブジェクト定義にはtypeよりもinterfaceを優先する
- ユニオン、インターセクション、マップ型にはtypeを使用する
- `any`の使用を避け、未知の型には`unknown`を優先する
- enumは避け、代わりにマップを使用する
- TypeScriptの組み込みユーティリティ型を活用する
- 再利用可能な型パターンにはジェネリクスを使用する
- 不変プロパティにはreadonlyを使用する
- 型安全性のために判別可能なユニオンを活用する
- ランタイム型チェックには型ガードを使用する
- 適切なnullチェックを実装する
- 必要でない限り型アサーションを避ける
- エラー処理とエッジケースを優先してください：
  - 関数の先頭でエラーとエッジケースを処理してください。
  - 深くネストされたif文を避けるため、エラー条件には早期リターンを使用してください。
  - 可読性向上のため、ハッピーパスを関数の最後に配置してください。
  - 不要なelse文は避け、代わりにif-returnパターンを使用してください。
  - 前提条件や無効な状態を早期に処理するためのガード節を使用してください。
  - 適切なエラーログとユーザーフレンドリーなエラーメッセージを実装してください。
  - 一貫したエラー処理のためにカスタムエラータイプまたはエラーファクトリの使用を検討してください。

## 構文とフォーマット

- 純粋関数には「function」キーワードを使用する
- 条件文で不要な中括弧は避け、単純な文には簡潔な構文を使用する
- 宣言的なJSXを使用する

## UIとスタイリング

- Tailwind CSSでレスポンシブデザインを実装し、モバイルファーストアプローチを採用する

## コンポーネント

- デフォルトでサーバーコンポーネントを使用する
- クライアントコンポーネントは'use client'で明示的にマークする
- クライアントコンポーネントはフォールバック付きのSuspenseでラップする
- 重要度の低いコンポーネントには動的ローディングを使用する
- 適切なエラーバウンダリを実装する

## React Hooks

- Hooksのルールに従う
- 再利用可能なロジックにはCustom Hooksを使用する
- Hooksは焦点を絞りシンプルに保つ
- useEffectやuseCallback, useMemoでは適切な依存配列を使用する
- 必要な場合はuseEffectでクリーンアップを実装する
- ネストされたHooksを避ける

## 状態管理

- クライアントサイドの状態を最小限に抑える
- 可能な場合はサーバー状態を優先する
- React Contextは控えめに使用する
- ローカルコンポーネントの状態にはuseStateを使用する
- 複雑な状態ロジックにはuseReducerを実装する
- 状態はできるだけ使用される場所の近くに保持する
- 適切な読み込み状態を実装する
- 非推奨の`useFormState`の代わりに`useActionState`を使用する
- 新しいプロパティ（data、method、action）を持つ強化された`useFormStatus`を活用する

## Data Fetching

- 可能な場合はデータ取得にサーバーコンポーネントを使用する
- データ取得に適切なエラー処理を実装する
- 適切なキャッシング戦略を使用する
- 読み込み状態とエラー状態を適切に処理する

## フォームとバリデーション

- フォームバリデーションにはZodを使用する
- 適切なサーバーサイドバリデーションを実装する
- フォームエラーを適切に処理する
- フォーム送信中は読み込み状態を表示する

## パフォーマンス最適化

- 'use client'、'useEffect'、'setState'の使用を最小限に抑え、React Server Components (RSC)を優先する
- クライアントコンポーネントはフォールバック付きのSuspenseでラップする
- 適切なメモ化を実装する（useMemo、useCallback）
- 処理コストの高いコンポーネントにはReact.memoを使用する
- 不要な再レンダリングを避ける
- 適切な遅延読み込みを実装する
- リストでは適切なkeyプロップを使用する
- レンダリングパフォーマンスをプロファイリングし最適化する

## アクセシビリティ

- セマンティックなHTML要素を使用する
- 適切なARIA属性を実装する
- キーボードナビゲーションを確保する
- フォーカス管理を処理する
- 画像には適切な代替テキストを提供する

## 主要な規約

- Web Vitals（LCP、CLS、FID）を最適化する
- 'use client'の使用を制限してください：
  - サーバーコンポーネントとNext.js SSRを優先する
  - 小さなコンポーネントでのWeb APIアクセスにのみ使用する
  - データ取得や状態管理には使用しない

データ取得、レンダリング、ルーティングについてはNext.jsのドキュメントに従ってください。
